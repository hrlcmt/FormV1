<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />
  <meta name="description" content="‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå - ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÅ‡∏≠‡∏• ‡∏ã‡∏µ ‡πÄ‡∏≠‡πá‡∏° ‡∏ó‡∏µ" />
  <title>‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå | LCMT</title>
  
  <!-- Preload & Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://cdn.tailwindcss.com" />
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Prompt', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans Thai', sans-serif;
    }
    
    /* Page Transitions */
    .page {
      display: none;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }
    
    .page.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    /* Custom Scrollbar */
    .policy-box::-webkit-scrollbar,
    .custom-scrollbar::-webkit-scrollbar {
      width: 8px;
    }
    
    .policy-box::-webkit-scrollbar-track,
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 4px;
    }
    
    .policy-box::-webkit-scrollbar-thumb,
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 4px;
    }
    
    .policy-box::-webkit-scrollbar-thumb:hover,
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
    
    /* Loading Spinner */
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3b82f6;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 0.8s linear infinite;
      display: inline-block;
      margin-right: 8px;
      vertical-align: middle;
    }
    
    .spinner-lg {
      width: 40px;
      height: 40px;
      border-width: 4px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Input validation styles */
    input:invalid:not(:placeholder-shown):not(:focus),
    textarea:invalid:not(:placeholder-shown):not(:focus),
    select:invalid:not(:focus) {
      border-color: #f87171 !important;
    }
    
    input:valid:not(:placeholder-shown),
    textarea:valid:not(:placeholder-shown),
    select:valid {
      border-color: #34d399;
    }
    
    /* Toast notification */
    .toast-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 400px;
    }
    
    .toast {
      padding: 16px 24px;
      border-radius: 12px;
      color: white;
      font-weight: 500;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      transform: translateX(150%);
      transition: transform 0.3s ease;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .toast.show {
      transform: translateX(0);
    }
    
    .toast.success { background-color: #10b981; }
    .toast.error { background-color: #ef4444; }
    .toast.warning { background-color: #f59e0b; }
    .toast.info { background-color: #3b82f6; }
    
    .toast-icon {
      font-size: 1.25rem;
    }
    
    /* Progress Bar */
    .progress-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: #e2e8f0;
      z-index: 999;
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #06b6d4);
      transition: width 0.3s ease;
      border-radius: 0 2px 2px 0;
    }
    
    /* Step Indicator */
    .step-indicator {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 2rem;
    }
    
    .step-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #e2e8f0;
      transition: all 0.3s ease;
    }
    
    .step-dot.active {
      background: #3b82f6;
      transform: scale(1.2);
    }
    
    .step-dot.completed {
      background: #10b981;
    }
    
    /* Button hover effects */
    .btn-primary {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      transition: all 0.3s ease;
    }
    
    .btn-success:hover:not(:disabled) {
      background: linear-gradient(135deg, #059669 0%, #047857 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(5, 150, 105, 0.4);
    }
    
    /* Modal backdrop animation */
    .modal-backdrop {
      backdrop-filter: blur(4px);
      animation: fadeIn 0.2s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-content {
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { 
        opacity: 0;
        transform: translateY(20px) scale(0.95);
      }
      to { 
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    /* Offline indicator */
    .offline-indicator {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: #f59e0b;
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      font-weight: 500;
      z-index: 1001;
      display: none;
    }
    
    .offline-indicator.show {
      display: block;
    }
    
    /* Focus visible for accessibility */
    :focus-visible {
      outline: 2px solid #3b82f6;
      outline-offset: 2px;
    }
    
    /* Reduced motion preference */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>

<body class="min-h-screen bg-slate-50 relative overflow-x-hidden">
  <!-- Progress Bar -->
  <div class="progress-container">
    <div id="progressBar" class="progress-bar" style="width: 0%"></div>
  </div>
  
  <!-- Offline Indicator -->
  <div id="offlineIndicator" class="offline-indicator">
    ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï
  </div>
  
  <!-- Decorative background -->
  <div aria-hidden="true" class="pointer-events-none absolute inset-x-0 -top-40 -z-10 flex justify-center opacity-60">
    <div class="h-72 w-[56rem] bg-gradient-to-tr from-blue-300 via-cyan-200 to-blue-100 blur-3xl rounded-full"></div>
  </div>
  <div aria-hidden="true" class="pointer-events-none absolute inset-0 -z-10" style="background-image: radial-gradient(circle at 1px 1px, rgba(99,102,241,.15) 1px, transparent 0); background-size: 24px 24px;"></div>
  
  <!-- Toast Container -->
  <div id="toastContainer" class="toast-container"></div>
  
  <main class="max-w-3xl mx-auto p-4 md:p-6 lg:p-10">
    
    <!-- ============================================================ -->
    <!-- Page 1: Registration Form -->
    <!-- ============================================================ -->
    <div id="page-register" class="page active" data-step="1">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        
        <!-- Header -->
        <header class="mb-6 text-center">
          <img 
            src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" 
            alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó LCMT" 
            class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain"
            loading="eager"
          />
          <h1 class="text-2xl md:text-4xl font-extrabold text-blue-700 leading-tight">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h1>
          <h2 class="text-xl md:text-3xl font-extrabold text-blue-700">‡πÅ‡∏•‡∏∞‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
          <p class="text-blue-500 mt-2">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÅ‡∏≠‡∏• ‡∏ã‡∏µ ‡πÄ‡∏≠‡πá‡∏° ‡∏ó‡∏µ</p>
        </header>
        
        <!-- Step Indicator -->
        <div class="step-indicator">
          <div class="step-dot active" title="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"></div>
          <div class="step-dot" title="‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥"></div>
          <div class="step-dot" title="PI Test A"></div>
          <div class="step-dot" title="PI Test B"></div>
          <div class="step-dot" title="Logical Set 1"></div>
          <div class="step-dot" title="Logical Set 2"></div>
          <div class="step-dot" title="Logical Set 3"></div>
          <div class="step-dot" title="English Test"></div>
          <div class="step-dot" title="‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô"></div>
        </div>
        
        <!-- Registration Form -->
        <form id="registerForm" class="space-y-6" novalidate>
          
          <!-- Section 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
          <fieldset class="space-y-4">
            <legend class="text-xl font-bold text-blue-800 border-b border-blue-200 pb-2 flex items-center gap-2 w-full">
              <span>üë§</span> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
            </legend>
            
            <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡πÑ‡∏ó‡∏¢) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="firstNameTH" class="block font-medium text-slate-700">
                  ‡∏ä‡∏∑‡πà‡∏≠ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢) <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="firstNameTH" 
                  name="FirstNameTH" 
                  type="text" 
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                  required 
                  pattern="[\u0E00-\u0E7F\s]+"
                  autocomplete="given-name"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="firstNameTHError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
              </div>
              <div>
                <label for="lastNameTH" class="block font-medium text-slate-700">
                  ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢) <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="lastNameTH" 
                  name="LastNameTH" 
                  type="text" 
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                  required 
                  pattern="[\u0E00-\u0E7F\s]+"
                  autocomplete="family-name"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="lastNameTHError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
              </div>
            </div>

            <!-- ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="firstName" class="block font-medium text-slate-700">
                  ‡∏ä‡∏∑‡πà‡∏≠ (‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="firstName" 
                  name="FirstName" 
                  type="text" 
                  placeholder="e.g., Nattapong" 
                  required 
                  pattern="[A-Za-z]+(?:[\s\-'][A-Za-z]+)*"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="firstNameError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
              </div>
              <div>
                <label for="lastName" class="block font-medium text-slate-700">
                  ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="lastName" 
                  name="LastName" 
                  type="text" 
                  placeholder="e.g., Chaiyaphum" 
                  required 
                  pattern="[A-Za-z]+(?:[\s\-'][A-Za-z]+)*"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="lastNameError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>
              </div>
            </div>

            <!-- ‡∏≠‡∏µ‡πÄ‡∏°‡∏• & ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="email" class="block font-medium text-slate-700">
                  ‡∏≠‡∏µ‡πÄ‡∏°‡∏• <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="email" 
                  name="Email" 
                  type="email" 
                  inputmode="email"
                  placeholder="name@example.com" 
                  required
                  autocomplete="email"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="emailError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
              </div>
              <div>
                <label for="phone" class="block font-medium text-slate-700">
                  ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå <span class="text-rose-500">*</span>
                </label>
                <input 
                  id="phone" 
                  name="Phone" 
                  type="tel" 
                  inputmode="numeric"
                  placeholder="0812345678" 
                  required 
                  pattern="^0[0-9]{8,9}$" 
                  maxlength="10"
                  autocomplete="tel"
                  class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
                <p id="phoneError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 10 ‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏ä‡πà‡∏ô 0812345678)</p>
              </div>
            </div>

            <!-- ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á -->
            <div>
              <label for="position" class="block font-medium text-slate-700">
                ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£ <span class="text-rose-500">*</span>
              </label>
              <input 
                id="position" 
                name="Position" 
                type="text" 
                placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£" 
                required 
                minlength="2"
                class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
              />
              <p id="positionError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</p>
            </div>
          </fieldset>

          <!-- Section 2: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ -->
          <fieldset class="space-y-4 pt-2">
            <legend class="text-xl font-bold text-blue-800 border-b border-blue-200 pb-2 flex items-center gap-2 w-full">
              <span>üéì</span> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
            </legend>

            <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏≤‡∏á‡∏ó‡∏´‡∏≤‡∏£ -->
            <div>
              <label class="block font-medium text-slate-700 mb-2">
                ‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏≤‡∏á‡∏ó‡∏´‡∏≤‡∏£ <span class="text-rose-500">*</span>
              </label>
              <div class="flex flex-col gap-2" role="radiogroup" aria-labelledby="military-label">
                <label class="inline-flex items-center cursor-pointer hover:bg-slate-50 p-2 rounded-lg transition-colors">
                  <input type="radio" name="MilitaryStatus" value="Passed" class="form-radio text-blue-600 h-5 w-5" required />
                  <span class="ml-3">‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏´‡∏≤‡∏£</span>
                </label>
                <label class="inline-flex items-center cursor-pointer hover:bg-slate-50 p-2 rounded-lg transition-colors">
                  <input type="radio" name="MilitaryStatus" value="NotPassed" class="form-radio text-blue-600 h-5 w-5" />
                  <span class="ml-3">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏´‡∏≤‡∏£</span>
                </label>
                <div class="flex items-center gap-2 p-2">
                  <label class="inline-flex items-center cursor-pointer">
                    <input type="radio" name="MilitaryStatus" value="Other" class="form-radio text-blue-600 h-5 w-5" id="militaryOtherRadio" />
                    <span class="ml-3">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                  </label>
                  <input 
                    type="text" 
                    id="militaryOtherText" 
                    name="MilitaryStatusOther" 
                    placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏" 
                    class="flex-1 rounded-lg border border-blue-100 px-3 py-2 text-sm shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 disabled:bg-slate-100 disabled:text-slate-400 transition-all" 
                    disabled
                    aria-label="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏≤‡∏á‡∏ó‡∏´‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
                  />
                </div>
              </div>
              <p id="militaryError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏≤‡∏á‡∏ó‡∏´‡∏≤‡∏£</p>
            </div>

            <!-- ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
            <div>
              <label for="educationLevel" class="block font-medium text-slate-700">
                ‡∏ß‡∏∏‡∏í‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î <span class="text-rose-500">*</span>
              </label>
              <select 
                id="educationLevel" 
                name="EducationLevel" 
                required 
                class="mt-1 w-full rounded-xl border border-blue-100 px-4 py-3 bg-white shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all"
              >
                <option value="" disabled selected>‚Äî ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äî</option>
                <option value="‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢ / ‡∏õ‡∏ß‡∏ä.">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢ / ‡∏õ‡∏ß‡∏ä.</option>
                <option value="‡∏≠‡∏ô‡∏∏‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤ / ‡∏õ‡∏ß‡∏™.">‡∏≠‡∏ô‡∏∏‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤ / ‡∏õ‡∏ß‡∏™.</option>
                <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡∏ï‡∏£‡∏µ</option>
                <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÇ‡∏ó</option>
                <option value="‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å">‡∏õ‡∏£‡∏¥‡∏ç‡∏ç‡∏≤‡πÄ‡∏≠‡∏Å</option>
                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
              </select>
              <p id="educationError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏∏‡∏í‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
            </div>

            <!-- ‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î -->
            <div class="pt-2">
              <label class="block font-medium text-slate-700 mb-2">
                ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? <span class="text-rose-500">*</span>
              </label>
              <div class="flex gap-6" role="radiogroup">
                <label class="inline-flex items-center cursor-pointer hover:bg-slate-50 p-2 rounded-lg transition-colors">
                  <input type="radio" name="DrugHistory" value="Yes" class="form-radio text-rose-600 h-5 w-5" required />
                  <span class="ml-3">‡πÄ‡∏Ñ‡∏¢</span>
                </label>
                <label class="inline-flex items-center cursor-pointer hover:bg-slate-50 p-2 rounded-lg transition-colors">
                  <input type="radio" name="DrugHistory" value="No" class="form-radio text-emerald-600 h-5 w-5" />
                  <span class="ml-3">‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢</span>
                </label>
              </div>
              <p id="drugError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</p>
            </div>
          </fieldset>

          <!-- Section 3: ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç -->
          <fieldset class="space-y-4 pt-2">
            <legend class="text-xl font-bold text-rose-700 border-b border-rose-200 pb-2 flex items-center gap-2 w-full">
              <span>üìú</span> ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£
            </legend>
            
            <div class="policy-box bg-slate-50 border border-slate-200 rounded-xl p-5 text-sm text-slate-700 leading-relaxed max-h-80 overflow-y-auto">
              <p class="font-bold text-black mb-2">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï‡∏õ‡∏•‡∏≠‡∏î‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î</p>
              <p class="mb-4">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏°‡∏µ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏ä‡∏µ‡∏ß‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏à‡∏∂‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏õ‡∏•‡∏≠‡∏î‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏°‡∏∂‡∏ô‡πÄ‡∏°‡∏≤‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏û‡∏µ‡∏¢‡∏á ‡∏¢‡∏≤‡∏ö‡πâ‡∏≤ ‡∏¢‡∏≤‡πÑ‡∏≠‡∏ã‡πå ‡∏Å‡∏±‡∏ç‡∏ä‡∏≤ ‡∏Å‡∏±‡∏ç‡∏ä‡∏á ‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡∏ä‡∏Å‡∏£‡∏∞‡∏ó‡πà‡∏≠‡∏°</p>
              <p class="mb-4">‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ô‡∏µ‡πâ ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (Conditional Offer) ‡πÇ‡∏î‡∏¢‡∏ó‡πà‡∏≤‡∏ô‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</p>
              <p class="mb-4"><strong>‡∏´‡∏≤‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î‡πÉ‡∏ô‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢:</strong> ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏î‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</p>
              
              <hr class="my-4 border-slate-300" />
              
              <p class="font-bold text-black mb-2">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß (PDPA)</p>
              <p class="mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ø ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Å‡πà‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å ‡πÄ‡∏ß‡πâ‡∏ô‡πÅ‡∏ï‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏¢‡∏≠‡∏°‡∏à‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
            </div>

            <!-- ‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç -->
            <div class="space-y-4 mt-4">
              <div>
                <label for="consentText1" class="block font-medium text-slate-700 mb-1">
                  ‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï‡∏õ‡∏•‡∏≠‡∏î‡∏™‡∏≤‡∏£‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î) <span class="text-rose-500">*</span>
                </label>
                <div class="flex items-center gap-2">
                  <span class="text-sm text-slate-500">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤</span>
                  <code class="bg-amber-100 text-amber-800 px-2 py-1 rounded font-bold">‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö</code>
                  <span class="text-sm text-slate-500">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô:</span>
                </div>
                <input 
                  type="text" 
                  id="consentText1" 
                  name="Consent1" 
                  placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö" 
                  required
                  autocomplete="off"
                  class="mt-2 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
              </div>
              
              <div>
                <label for="consentText2" class="block font-medium text-slate-700 mb-1">
                  ‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç (‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢ PDPA) <span class="text-rose-500">*</span>
                </label>
                <div class="flex items-center gap-2">
                  <span class="text-sm text-slate-500">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤</span>
                  <code class="bg-amber-100 text-amber-800 px-2 py-1 rounded font-bold">‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö</code>
                  <span class="text-sm text-slate-500">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô:</span>
                </div>
                <input 
                  type="text" 
                  id="consentText2" 
                  name="Consent2" 
                  placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö" 
                  required
                  autocomplete="off"
                  class="mt-2 w-full rounded-xl border border-blue-100 px-4 py-3 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100 transition-all" 
                />
              </div>
              <p id="consentError" class="mt-1 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö" ‡πÉ‡∏ô‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ä‡πà‡∏≠‡∏á</p>
            </div>

            <!-- ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
            <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mt-4">
              <label class="inline-flex items-start cursor-pointer">
                <input 
                  type="checkbox" 
                  id="confirmEmail" 
                  name="ConfirmEmail" 
                  required
                  class="form-checkbox text-blue-600 h-5 w-5 mt-0.5 rounded" 
                />
                <span class="ml-3 text-slate-700">
                  ‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
                </span>
              </label>
              <p id="confirmEmailError" class="mt-2 text-sm text-rose-600 hidden">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•</p>
            </div>
          </fieldset>

          <!-- Submit Button -->
          <div class="pt-4">
            <button 
              id="submitBtn" 
              type="submit" 
              class="btn-primary w-full rounded-xl px-6 py-4 text-white font-semibold text-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
            >
              ‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 2: Instructions with Video -->
    <!-- ============================================================ -->
    <div id="page-instructions" class="page" data-step="2">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-6 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üìπ ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
          <p class="mt-2 text-slate-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠</p>
        </header>

        <!-- Video Container -->
        <div class="relative aspect-video w-full max-w-2xl mx-auto rounded-2xl overflow-hidden shadow-lg bg-slate-900">
          <div id="videoPlayer"></div>
          <div id="videoLoading" class="absolute inset-0 flex items-center justify-center bg-slate-900">
            <div class="spinner spinner-lg"></div>
          </div>
        </div>

        <!-- Video Status -->
        <div class="mt-4 text-center space-y-2">
          <p class="text-slate-600">
            ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="videoStatus" class="font-semibold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
          </p>
          <p class="text-slate-500 text-sm">
            ‡πÄ‡∏ß‡∏•‡∏≤: <span id="timeDisplay">0:00</span> / <span id="durationDisplay">0:00</span>
          </p>
        </div>

        <!-- Navigation -->
        <div class="mt-8 flex justify-between items-center">
          <button data-backpage="page-register" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="btn-instruction-next" data-nextpage="page-pi-a" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 3: PI Test A -->
    <!-- ============================================================ -->
    <div id="page-pi-a" class="page" data-step="3">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üîπ 1. The Predictive Index</h1>
          <p class="mt-1 text-xl font-semibold text-slate-700">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î A</p>
          <h2 class="mt-6 text-xl font-semibold text-red-600">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏à‡∏≤‡∏Å "‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô"</h2>
          <p class="mt-4 max-w-2xl mx-auto text-slate-600">
            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
          </p>
        </div>
        
        <div class="mt-10 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/5f04db6d-b251-4b2c-ae65-3b2b84ebe144.png" alt="Click icon" class="h-64 md:h-96 w-auto mx-auto mb-6" loading="lazy" />
          <button id="startPiTestA" class="btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg">
            ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
          </button>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-instructions" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="pi-a-next" data-nextpage="page-pi-b" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 4: PI Test B -->
    <!-- ============================================================ -->
    <div id="page-pi-b" class="page" data-step="4">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üîπ 2. The Predictive Index</h1>
          <p class="mt-1 text-xl font-semibold text-slate-700">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î B</p>
          <h2 class="mt-6 text-xl font-semibold text-red-600">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠: ‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏à‡∏≤‡∏Å "‡∏ï‡∏±‡∏ß‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô"</h2>
          <p class="mt-4 max-w-2xl mx-auto text-slate-600">
            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
          </p>
        </div>
        
        <div class="mt-10 text-center">
          <img src="https://img2.pic.in.th/pic/ChatGPT-Image-16-..-2568-11_32_11.png" alt="Click icon" class="h-64 md:h-96 w-auto mx-auto mb-6" loading="lazy" />
          <button id="startPiTestB" class="btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg">
            ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î B
          </button>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-pi-a" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="pi-b-next" data-nextpage="page-logical-intro" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 5: Logical Reasoning Set 1 -->
    <!-- ============================================================ -->
    <div id="page-logical-intro" class="page" data-step="5">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üß† ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏£‡∏Å‡∏∞ (Logical Reasoning)</h1>
          <div class="mt-4 max-w-2xl mx-auto text-slate-600 space-y-2">
            <p>‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</p>
            <p>‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 3 ‡∏ä‡∏∏‡∏î (50 ‡∏Ç‡πâ‡∏≠/‡∏ä‡∏∏‡∏î) ‡πÇ‡∏î‡∏¢‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏∏‡∏î‡∏°‡∏µ‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î <strong class="text-red-600">12 ‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</strong></p>
          </div>
          
          <div class="mt-6 max-w-2xl mx-auto border-2 border-blue-500 rounded-2xl p-4 bg-blue-50/50">
            <p class="text-xl font-semibold text-blue-800">üîë ‡∏ó‡∏∏‡∏Å‡∏ä‡∏∏‡∏î‡∏à‡∏∞‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</p>
            <p class="mt-2 text-lg text-slate-700">
              ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏≠‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà LINE OFFICIAL 
              <a href="https://lin.ee/xYHJZkc" target="_blank" rel="noopener" class="text-blue-600 font-bold hover:underline">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</a>
            </p>
            <p class="mt-1 text-sm text-slate-600">(‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà "‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π" ‡πÅ‡∏•‡∏∞ "‡∏Ç‡∏≠‡∏£‡∏´‡∏±‡∏™")</p>
          </div>
          
          <p class="mt-6 text-xl md:text-2xl font-bold text-slate-800">‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 ‡∏à‡∏≤‡∏Å 3</p>
        </div>
        
        <div class="mt-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-121252.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg" loading="lazy" />
        </div>
        
        <div class="mt-8 text-center">
          <button id="startTestBtn1" class="btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg">
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1
          </button>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-pi-b" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="logical-intro-next" data-nextpage="page-logical-set2" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 6: Logical Reasoning Set 2 -->
    <!-- ============================================================ -->
    <div id="page-logical-set2" class="page" data-step="6">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üß† ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏£‡∏Å‡∏∞ ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</h1>
          <p class="mt-1 text-xl font-semibold text-slate-700">Logical Reasoning - Set 2</p>
          <p class="mt-6 text-xl md:text-2xl font-bold text-slate-800">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å 2 ‡∏ä‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢!</p>
        </div>
        
        <div class="mt-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-122427.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg" loading="lazy" />
        </div>
        
        <div class="mt-8 text-center">
          <button id="startTestBtn2" class="btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg">
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2
          </button>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-logical-intro" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="logical-set2-next" data-nextpage="page-logical-set3" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 7: Logical Reasoning Set 3 -->
    <!-- ============================================================ -->
    <div id="page-logical-set3" class="page" data-step="7">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üß† ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏£‡∏Å‡∏∞ ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3</h1>
          <p class="mt-1 text-xl font-semibold text-slate-700">Logical Reasoning - Set 3</p>
          <p class="mt-6 text-xl md:text-2xl font-bold text-emerald-600">üéâ ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏£‡∏Å‡∏∞‡∏ä‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢!</p>
        </div>
        
        <div class="mt-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-122427.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg" loading="lazy" />
        </div>
        
        <div class="mt-8 text-center">
          <button id="startTestBtn3" class="btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg">
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3
          </button>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-logical-set2" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="logical-set3-next" data-nextpage="page-english-intro" class="nav-btn btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 8: English Test -->
    <!-- ============================================================ -->
    <div id="page-english-intro" class="page" data-step="8">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <h1 class="text-2xl md:text-3xl font-bold text-blue-700">üìö ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</h1>
          <p class="mt-1 text-xl font-semibold text-slate-700">English Testing</p>
          <p class="mt-6 text-lg text-slate-800">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô 28 ‡∏Ç‡πâ‡∏≠ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤ <strong class="text-red-600">25 ‡∏ô‡∏≤‡∏ó‡∏µ</strong></p>
          <p class="mt-2 text-emerald-600 font-semibold">üèÅ ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ä‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢!</p>
        </div>
        
        <div class="mt-10 text-center">
          <a 
            id="english-link" 
            href="https://www.classmarker.com/online-test/start/access-code/?quiz=pgn686b47061a703" 
            target="_blank" 
            rel="noopener noreferrer" 
            class="inline-block btn-success rounded-xl px-8 py-4 text-white font-semibold text-lg shadow-lg"
          >
            üîó ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
          </a>
        </div>
        
        <div class="mt-12 flex justify-between items-center">
          <button data-backpage="page-logical-set3" class="nav-btn rounded-xl px-6 py-3 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2 transition-all">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button id="finish-test-btn" class="btn-primary rounded-xl px-6 py-3 text-white font-semibold flex items-center gap-2">
            ‚úÖ ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô
          </button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- Page 9: Completion -->
    <!-- ============================================================ -->
    <div id="page-complete" class="page" data-step="9">
      <div class="mt-6 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-4 md:p-8">
        <header class="mb-8 text-center">
          <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="mx-auto mb-4 w-full max-w-[420px] object-contain" loading="lazy" />
        </header>
        
        <div class="text-center">
          <div class="inline-flex items-center justify-center w-24 h-24 bg-emerald-100 rounded-full mb-6 animate-bounce">
            <svg class="w-12 h-12 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          <h1 class="text-2xl md:text-4xl font-bold text-emerald-600">üéâ ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!</h1>
          <p class="mt-2 text-slate-600">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</p>
          
          <!-- Summary Card -->
          <div class="mt-8 text-left max-w-md mx-auto bg-slate-50 border border-slate-200 rounded-xl p-6 space-y-3">
            <h3 class="font-bold text-slate-800 text-lg mb-4 text-center">üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h3>
            <p><span class="font-medium text-slate-600">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</span> <span id="display-fullname" class="text-slate-800"></span></p>
            <p><span class="font-medium text-slate-600">‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</span> <span id="display-email" class="text-slate-800"></span></p>
            <p><span class="font-medium text-slate-600">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£:</span> <span id="display-position" class="text-slate-800"></span></p>
            <p><span class="font-medium text-slate-600">IP Address:</span> <span id="display-ip" class="text-slate-800"></span></p>
            <p><span class="font-medium text-slate-600">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô:</span> <span id="display-timestamp" class="text-slate-800"></span></p>
          </div>
          
          <!-- Important Notice -->
          <div class="mt-8 max-w-lg mx-auto border-2 border-rose-500 rounded-2xl p-6 bg-rose-50/50">
            <p class="text-xl font-bold text-rose-800">‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!</p>
            <p class="mt-3 text-base text-slate-700">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÉ‡∏ô LINE OFFICIAL</p>
            <p class="mt-2 text-sm text-slate-600">‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ô‡∏µ‡πâ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î</p>
            <a 
              href="https://lin.ee/xYHJZkc" 
              target="_blank" 
              rel="noopener" 
              class="inline-block mt-4 btn-success rounded-xl px-6 py-3 text-white font-semibold"
            >
              üí¨ ‡∏™‡πà‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏ó‡∏≤‡∏á LINE
            </a>
          </div>
        </div>
      </div>
    </div>

  </main>

  <!-- ============================================================ -->
  <!-- Modals -->
  <!-- ============================================================ -->
  
  <!-- PI Instruction Modal -->
  <div id="piInstructionModal" class="fixed inset-0 bg-black/60 hidden grid place-items-center z-50 p-4 modal-backdrop">
    <div class="modal-content bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
      <h2 class="text-2xl font-bold text-blue-700 text-center">üìã ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</h2>
      <p id="piInstructionText" class="mt-4 text-center text-slate-700 text-lg"></p>
      <div class="mt-6">
        <button id="confirmPiModalBtn" class="w-full btn-primary rounded-lg px-5 py-3 text-white font-semibold text-lg">
          ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        </button>
      </div>
    </div>
  </div>

  <!-- Warning Modal -->
  <div id="warningModal" class="fixed inset-0 bg-black/60 hidden grid place-items-center z-50 p-4 modal-backdrop">
    <div class="modal-content bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
      <h2 class="text-3xl font-extrabold text-rose-600 text-center">‚ö†Ô∏è ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡πÜ</h2>
      <ul class="list-disc list-inside mt-6 space-y-4 text-slate-700 text-lg">
        <li>‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</li>
        <li>‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡πÑ‡∏î‡πâ ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠</li>
        <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö <strong>Full Screen ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</strong></li>
        <li>‡∏´‡∏≤‡∏Å‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏Å‡∏¥‡∏ô 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ <strong class="text-red-600">"‡πÇ‡∏°‡∏Ü‡∏∞"</strong></li>
      </ul>
      <div class="mt-8 flex flex-col sm:flex-row-reverse gap-3">
        <button id="confirmModalBtn" class="w-full btn-primary rounded-lg px-5 py-3 text-white font-semibold text-lg">
          ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
        </button>
        <button id="cancelModalBtn" class="w-full rounded-lg px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-lg transition-colors">
          ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
        </button>
      </div>
    </div>
  </div>

  <!-- Completion Confirmation Modal -->
  <div id="completionModal" class="fixed inset-0 bg-black/60 hidden grid place-items-center z-50 p-4 modal-backdrop">
    <div class="modal-content bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
      <h2 class="text-2xl font-bold text-blue-700 text-center">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
      <p class="mt-4 text-center text-slate-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß</p>
      
      <div id="completionChecklist" class="mt-6 space-y-3">
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>PI Test A - ‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£</span>
        </label>
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>PI Test B - ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£</span>
        </label>
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>Logical Reasoning ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 1</span>
        </label>
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>Logical Reasoning ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 2</span>
        </label>
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>Logical Reasoning ‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà 3</span>
        </label>
        <label class="flex items-center gap-3 p-3 bg-slate-50 rounded-lg cursor-pointer hover:bg-slate-100 transition-colors">
          <input type="checkbox" class="h-5 w-5 rounded accent-emerald-600" />
          <span>English Test</span>
        </label>
      </div>
      
      <div class="mt-8 flex flex-col sm:flex-row-reverse gap-3">
        <button id="confirmCompletionBtn" class="w-full btn-success rounded-lg px-5 py-3 text-white font-semibold text-lg">
          ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏î‡∏π‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ
        </button>
        <button id="cancelCompletionBtn" class="w-full rounded-lg px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-lg transition-colors">
          ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================================ -->
  <!-- YouTube IFrame API -->
  <!-- ============================================================ -->
  <script src="https://www.youtube.com/iframe_api"></script>
  
  <script>
    // ============================================================
    // CONFIGURATION
    // ============================================================
    const CONFIG = {
      SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbwbD7ooCm2mA5gdR9YLYJg0RNMU9YCJehG58mLoFxPvIqfrEeb-088LCDuALAJSHUPG/exec', // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô URL ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy
      YOUTUBE_VIDEO_ID: 'jPi1OpKzo64', // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Video ID ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (‡∏ñ‡πâ‡∏≤ embed ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ö‡∏ô YouTube ‡πÅ‡∏ó‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
      MAX_RETRY_ATTEMPTS: 3,
      RETRY_DELAY_MS: 2000,
      STORAGE_KEY: 'lcmt_application_data',
      PROGRESS_KEY: 'lcmt_application_progress'
    };

    // ============================================================
    // APPLICATION STATE
    // ============================================================
    const AppState = {
      userData: {},
      currentPage: 'page-register',
      isSubmitting: false,
      completedTests: new Set(),
      retryCount: 0
    };

    // ============================================================
    // UTILITY FUNCTIONS
    // ============================================================
    
    // Toast Notification System
    function showToast(message, type = 'success', duration = 4000) {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      
      const icons = {
        success: '‚úÖ',
        error: '‚ùå',
        warning: '‚ö†Ô∏è',
        info: '‚ÑπÔ∏è'
      };
      
      toast.className = `toast ${type}`;
      toast.innerHTML = `<span class="toast-icon">${icons[type]}</span><span>${message}</span>`;
      container.appendChild(toast);
      
      // Trigger animation
      requestAnimationFrame(() => toast.classList.add('show'));
      
      // Auto remove
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, duration);
    }

    // Format time for video
    function formatTime(seconds) {
      const min = Math.floor(seconds / 60);
      const sec = Math.floor(seconds % 60);
      return `${min}:${sec < 10 ? '0' : ''}${sec}`;
    }

    // Update progress bar
    function updateProgressBar(step, totalSteps = 9) {
      const percentage = (step / totalSteps) * 100;
      document.getElementById('progressBar').style.width = `${percentage}%`;
      
      // Update step dots
      const dots = document.querySelectorAll('.step-dot');
      dots.forEach((dot, index) => {
        dot.classList.remove('active', 'completed');
        if (index < step - 1) {
          dot.classList.add('completed');
        } else if (index === step - 1) {
          dot.classList.add('active');
        }
      });
    }

    // Save progress to localStorage
    function saveProgress() {
      try {
        const data = {
          userData: AppState.userData,
          currentPage: AppState.currentPage,
          completedTests: Array.from(AppState.completedTests),
          timestamp: Date.now()
        };
        localStorage.setItem(CONFIG.PROGRESS_KEY, JSON.stringify(data));
      } catch (e) {
        console.warn('Could not save progress:', e);
      }
    }

    // Load progress from localStorage
    function loadProgress() {
      try {
        const saved = localStorage.getItem(CONFIG.PROGRESS_KEY);
        if (saved) {
          const data = JSON.parse(saved);
          // Only restore if within 24 hours
          if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
            return data;
          }
        }
      } catch (e) {
        console.warn('Could not load progress:', e);
      }
      return null;
    }

    // Clear saved progress
    function clearProgress() {
      try {
        localStorage.removeItem(CONFIG.PROGRESS_KEY);
      } catch (e) {
        console.warn('Could not clear progress:', e);
      }
    }

    // ============================================================
    // PAGE NAVIGATION
    // ============================================================
    function showPage(pageId) {
      const pages = document.querySelectorAll('.page');
      pages.forEach(page => page.classList.remove('active'));
      
      const newPage = document.getElementById(pageId);
      if (newPage) {
        newPage.classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        // Get step number
        const step = parseInt(newPage.dataset.step) || 1;
        updateProgressBar(step);
        
        AppState.currentPage = pageId;
        saveProgress();
        
        // Handle completion page
        if (pageId === 'page-complete') {
          populateCompletionPage();
          clearProgress();
        }
      }
    }

    function populateCompletionPage() {
      const u = AppState.userData;
      document.getElementById('display-fullname').textContent = 
        `${u.firstNameTH || ''} ${u.lastNameTH || ''} (${u.firstName || ''} ${u.lastName || ''})`;
      document.getElementById('display-email').textContent = u.email || '';
      document.getElementById('display-position').textContent = u.position || '';
      document.getElementById('display-ip').textContent = u.ip || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏î‡πâ';
      document.getElementById('display-timestamp').textContent = new Date().toLocaleString('th-TH');
    }

    // ============================================================
    // FORM VALIDATION
    // ============================================================
    const ValidationRules = {
      firstNameTH: {
        pattern: /^[\u0E00-\u0E7F\s]+$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'
      },
      lastNameTH: {
        pattern: /^[\u0E00-\u0E7F\s]+$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'
      },
      firstName: {
        pattern: /^[A-Za-z]+(?:[\s\-'][A-Za-z]+)*$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'
      },
      lastName: {
        pattern: /^[A-Za-z]+(?:[\s\-'][A-Za-z]+)*$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'
      },
      email: {
        pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'
      },
      phone: {
        pattern: /^0[0-9]{8,9}$/,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå 10 ‡∏´‡∏•‡∏±‡∏Å'
      },
      position: {
        minLength: 2,
        message: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á'
      }
    };

    function validateField(input) {
      const errorEl = document.getElementById(input.id + 'Error');
      const rule = ValidationRules[input.id];
      let isValid = true;
      let value = input.value.trim();

      if (!value) {
        isValid = false;
      } else if (rule) {
        if (rule.pattern && !rule.pattern.test(value)) {
          isValid = false;
        }
        if (rule.minLength && value.length < rule.minLength) {
          isValid = false;
        }
        if (rule.min !== undefined && rule.max !== undefined) {
          const num = parseInt(value);
          if (isNaN(num) || num < rule.min || num > rule.max) {
            isValid = false;
          }
        }
      }

      if (errorEl) {
        errorEl.classList.toggle('hidden', isValid);
      }
      return isValid;
    }

    function validateForm() {
      let isValid = true;
      const errors = [];

      // Validate text fields
      const basicFields = ['firstNameTH', 'lastNameTH', 'firstName', 'lastName', 'email', 'phone', 'position'];
      basicFields.forEach(id => {
        const input = document.getElementById(id);
        if (input && !validateField(input)) {
          isValid = false;
          errors.push(id);
        }
      });

      // Validate Military Status
      const militaryStatus = document.querySelector('input[name="MilitaryStatus"]:checked');
      const militaryOtherText = document.getElementById('militaryOtherText');
      const militaryError = document.getElementById('militaryError');
      
      if (!militaryStatus) {
        isValid = false;
        militaryError?.classList.remove('hidden');
      } else if (militaryStatus.value === 'Other' && !militaryOtherText.value.trim()) {
        isValid = false;
        militaryError?.classList.remove('hidden');
      } else {
        militaryError?.classList.add('hidden');
      }

      // Validate Education Level
      const eduLevel = document.getElementById('educationLevel');
      const eduError = document.getElementById('educationError');
      if (!eduLevel.value) {
        isValid = false;
        eduError?.classList.remove('hidden');
      } else {
        eduError?.classList.add('hidden');
      }

      // Validate Drug History
      const drugHistory = document.querySelector('input[name="DrugHistory"]:checked');
      const drugError = document.getElementById('drugError');
      if (!drugHistory) {
        isValid = false;
        drugError?.classList.remove('hidden');
      } else {
        drugError?.classList.add('hidden');
      }

      // Validate Consent
      const consent1 = document.getElementById('consentText1');
      const consent2 = document.getElementById('consentText2');
      const consentError = document.getElementById('consentError');
      if (!consent1.value.includes('‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö') || !consent2.value.includes('‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö')) {
        isValid = false;
        consentError?.classList.remove('hidden');
      } else {
        consentError?.classList.add('hidden');
      }

      // Validate Email Confirmation
      const confirmEmail = document.getElementById('confirmEmail');
      const confirmEmailError = document.getElementById('confirmEmailError');
      if (!confirmEmail.checked) {
        isValid = false;
        confirmEmailError?.classList.remove('hidden');
      } else {
        confirmEmailError?.classList.add('hidden');
      }

      return { isValid, errors };
    }

    // ============================================================
    // FORM SUBMISSION WITH RETRY
    // ============================================================
    async function submitForm(retryCount = 0) {
      const submitBtn = document.getElementById('submitBtn');
      const militaryStatus = document.querySelector('input[name="MilitaryStatus"]:checked');
      const militaryOtherText = document.getElementById('militaryOtherText');
      const drugHistory = document.querySelector('input[name="DrugHistory"]:checked');
      const eduLevel = document.getElementById('educationLevel');

      // Collect user data
      AppState.userData = {
        firstNameTH: document.getElementById('firstNameTH').value.trim(),
        lastNameTH: document.getElementById('lastNameTH').value.trim(),
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.replace(/[-\s]/g, ''),
        position: document.getElementById('position').value.trim(),
        military: militaryStatus.value === 'Other' ? militaryOtherText.value.trim() : militaryStatus.value,
        eduLevel: eduLevel.value,
        drugHistory: drugHistory.value,
        consent1: document.getElementById('consentText1').value.trim(),
        consent2: document.getElementById('consentText2').value.trim()
      };

      // Fetch IP Address
      try {
        const ipResponse = await fetch('https://api.ipify.org?format=json');
        const ipData = await ipResponse.json();
        AppState.userData.ip = ipData.ip;
      } catch (e) {
        console.warn('Could not fetch IP:', e);
        AppState.userData.ip = 'N/A';
      }

      // Prepare FormData
      const formData = new FormData();
      formData.append('FirstNameTH', AppState.userData.firstNameTH);
      formData.append('LastNameTH', AppState.userData.lastNameTH);
      formData.append('FirstName', AppState.userData.firstName);
      formData.append('LastName', AppState.userData.lastName);
      formData.append('Email', AppState.userData.email);
      formData.append('Phone', AppState.userData.phone);
      formData.append('Position', AppState.userData.position);
      formData.append('MilitaryStatus', AppState.userData.military);
      formData.append('EducationLevel', AppState.userData.eduLevel);
      formData.append('DrugHistory', AppState.userData.drugHistory);
      formData.append('Consent1', AppState.userData.consent1);
      formData.append('Consent2', AppState.userData.consent2);
      formData.append('IPAddress', AppState.userData.ip);

      try {
        const response = await fetch(CONFIG.SCRIPT_URL, {
          method: 'POST',
          body: formData
        });

        const result = await response.json();

        if (result.result === 'success') {
          console.log('Data saved successfully, row:', result.row);
          showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
          saveProgress();
          showPage('page-instructions');
          return true;
        } else {
          throw new Error(result.error || 'Unknown error');
        }

      } catch (error) {
        console.error('Submission error:', error);

        if (retryCount < CONFIG.MAX_RETRY_ATTEMPTS) {
          showToast(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà... (${retryCount + 1}/${CONFIG.MAX_RETRY_ATTEMPTS})`, 'warning');
          await new Promise(r => setTimeout(r, CONFIG.RETRY_DELAY_MS));
          return submitForm(retryCount + 1);
        } else {
          showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏û‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡∏±‡∏î‡πÑ‡∏õ', 'warning');
          saveProgress();
          setTimeout(() => showPage('page-instructions'), 1500);
          return false;
        }
      }
    }

    // ============================================================
    // YOUTUBE PLAYER
    // ============================================================
    let player;
    let videoInterval;

    function onYouTubeIframeAPIReady() {
      try {
        player = new YT.Player('videoPlayer', {
          height: '100%',
          width: '100%',
          videoId: CONFIG.YOUTUBE_VIDEO_ID,
          playerVars: {
            'playsinline': 1,
            'rel': 0,
            'modestbranding': 1,
            'controls': 1,
            'origin': window.location.origin
          },
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange,
            'onError': onPlayerError
          }
        });
      } catch (err) {
        console.error('YouTube Player Init Error:', err);
        showVideoFallback();
      }
    }

    function onPlayerReady(event) {
      document.getElementById('videoLoading').style.display = 'none';
      document.getElementById('videoStatus').textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô';
      document.getElementById('durationDisplay').textContent = formatTime(player.getDuration());
    }

    function onPlayerStateChange(event) {
      const statusEl = document.getElementById('videoStatus');
      
      if (event.data === YT.PlayerState.PLAYING) {
        statusEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô';
        statusEl.className = 'font-semibold text-green-600';
        
        if (videoInterval) clearInterval(videoInterval);
        videoInterval = setInterval(checkVideoTime, 1000);
        
      } else if (event.data === YT.PlayerState.PAUSED) {
        statusEl.textContent = '‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß';
        statusEl.className = 'font-semibold text-amber-600';
        
      } else if (event.data === YT.PlayerState.ENDED) {
        statusEl.textContent = '‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‚úì';
        statusEl.className = 'font-semibold text-emerald-600';
        enableVideoCheckbox();
      }
    }

    function onPlayerError(event) {
      console.error('YouTube Player Error:', event.data);
      // Error 150/101 = embed restricted by owner, Error 2 = invalid ID, Error 5 = HTML5 error
      const blockedErrors = [101, 150];
      if (blockedErrors.includes(event.data)) {
        showVideoFallback();
      } else {
        document.getElementById('videoLoading').innerHTML = 
          '<p class="text-white text-center p-4">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</p>';
        document.getElementById('videoStatus').textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
      }
      // Allow bypass on error
      enableVideoCheckbox();
    }

    function showVideoFallback() {
      const youtubeUrl = 'https://www.youtube.com/watch?v=' + CONFIG.YOUTUBE_VIDEO_ID;
      const container = document.getElementById('videoPlayer')
        ? document.getElementById('videoPlayer').parentElement
        : document.querySelector('.aspect-video');
      if (!container) return;
      container.innerHTML = 
        '<div class="flex flex-col items-center justify-center h-full bg-gradient-to-b from-slate-800 to-slate-900 p-6 text-center" style="min-height:280px;">' +
          '<div class="text-5xl mb-4">üé¨</div>' +
          '<p class="text-white text-lg font-semibold mb-2">‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ</p>' +
          '<p class="text-slate-300 text-sm mb-6">‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡∏ï‡∏±‡∏ß (Embed) ‡πÇ‡∏î‡∏¢‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á</p>' +
          '<a href="' + youtubeUrl + '" target="_blank" rel="noopener noreferrer" ' +
             'class="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-3 rounded-xl transition-all shadow-lg" ' +
             'style="text-decoration:none;">' +
            '‚ñ∂ ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ö‡∏ô YouTube' +
          '</a>' +
          '<p class="text-slate-400 text-xs mt-4">‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</p>' +
        '</div>';
      const statusEl = document.getElementById('videoStatus');
      if (statusEl) {
        statusEl.textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏ö‡∏ô YouTube';
        statusEl.className = 'font-semibold text-amber-600';
      }
      enableVideoCheckbox();
    }

    function checkVideoTime() {
      if (!player || !player.getCurrentTime) return;

      const currentTime = player.getCurrentTime();
      const duration = player.getDuration();

      document.getElementById('timeDisplay').textContent = formatTime(currentTime);
      document.getElementById('durationDisplay').textContent = formatTime(duration);

      // Enable checkbox when video is almost complete (within 3 seconds)
      if (duration > 0 && (duration - currentTime) <= 3) {
        clearInterval(videoInterval);
        enableVideoCheckbox();
      }
    }

    function enableVideoCheckbox() {
      const checkbox = document.getElementById('videoWatchedCheckbox');
      if (checkbox) {
        checkbox.disabled = false;
        checkbox.classList.remove('cursor-not-allowed', 'opacity-50');
        checkbox.classList.add('cursor-pointer');
      }
    }

    // ============================================================
    // TEST BUTTONS AND MODALS
    // ============================================================
    const piTestConfig = {
      startPiTestA: {
        url: 'https://docs.google.com/forms/d/e/1FAIpQLSf1bMAy5RZ1dGTQGeoaAvA-B0LJ4Z4xaxM8vdwkBZqwIGowZA/viewform',
        next: 'pi-a-next',
        instruction: '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠ ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤ ‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πâ‡∏ô'
      },
      startPiTestB: {
        url: 'https://docs.google.com/forms/d/e/1FAIpQLSf9UMwFSVatVey0ivACu3wk4kPyvI3VL2NQXNUn2_zZA7noSg/viewform',
        next: 'pi-b-next',
        instruction: '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠ ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤ ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á'
      }
    };

    const logicalTestConfig = {
      startTestBtn1: { 
        url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=r4e686b42fada169', 
        next: 'logical-intro-next' 
      },
      startTestBtn2: { 
        url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=99b686b44e854477', 
        next: 'logical-set2-next' 
      },
      startTestBtn3: { 
        url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=tmg686b45fb6b665', 
        next: 'logical-set3-next' 
      }
    };

    // ============================================================
    // MAIN INITIALIZATION
    // ============================================================
    document.addEventListener('DOMContentLoaded', () => {
      // Check for saved progress
      const savedProgress = loadProgress();
      if (savedProgress && savedProgress.currentPage !== 'page-register') {
        if (confirm('‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
          AppState.userData = savedProgress.userData || {};
          AppState.completedTests = new Set(savedProgress.completedTests || []);
          showPage(savedProgress.currentPage);
        } else {
          clearProgress();
        }
      }

      // Network status monitoring
      window.addEventListener('online', () => {
        document.getElementById('offlineIndicator').classList.remove('show');
        showToast('‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡πâ‡∏ß', 'success');
      });

      window.addEventListener('offline', () => {
        document.getElementById('offlineIndicator').classList.add('show');
        showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï', 'error');
      });

      // Navigation buttons
      document.querySelectorAll('.nav-btn').forEach(button => {
        button.addEventListener('click', () => {
          const targetPageId = button.dataset.nextpage || button.dataset.backpage;
          if (targetPageId) showPage(targetPageId);
        });
      });

      // Military radio logic
      const militaryRadios = document.querySelectorAll('input[name="MilitaryStatus"]');
      const militaryOtherText = document.getElementById('militaryOtherText');
      
      militaryRadios.forEach(radio => {
        radio.addEventListener('change', () => {
          if (radio.value === 'Other') {
            militaryOtherText.disabled = false;
            militaryOtherText.focus();
          } else {
            militaryOtherText.disabled = true;
            militaryOtherText.value = '';
          }
        });
      });

      // Real-time validation
      Object.keys(ValidationRules).forEach(id => {
        const input = document.getElementById(id);
        if (input) {
          input.addEventListener('blur', () => validateField(input));
          input.addEventListener('input', () => {
            const errorEl = document.getElementById(id + 'Error');
            if (errorEl && !errorEl.classList.contains('hidden')) {
              validateField(input);
            }
          });
        }
      });

      // Form submission
      const registerForm = document.getElementById('registerForm');
      registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        if (AppState.isSubmitting) return;
        
        const { isValid, errors } = validateForm();
        
        if (isValid) {
          AppState.isSubmitting = true;
          const submitBtn = document.getElementById('submitBtn');
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<span class="spinner"></span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
          
          try {
            await submitForm();
          } finally {
            AppState.isSubmitting = false;
            submitBtn.disabled = false;
            submitBtn.innerHTML = '‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö';
          }
        } else {
          const firstError = document.querySelector('.text-rose-600:not(.hidden)');
          if (firstError) {
            firstError.closest('div')?.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }
          showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
        }
      });

      // Video checkbox
      const videoCheckbox = document.getElementById('videoWatchedCheckbox');
      const instructionNextBtn = document.getElementById('btn-instruction-next');
      
      if (videoCheckbox && instructionNextBtn) {
        videoCheckbox.addEventListener('change', () => {
          instructionNextBtn.disabled = !videoCheckbox.checked;
        });
      }

      // PI Test modals
      const piModal = document.getElementById('piInstructionModal');
      const piText = document.getElementById('piInstructionText');
      const confirmPiBtn = document.getElementById('confirmPiModalBtn');
      let currentPiTest = {};

      Object.entries(piTestConfig).forEach(([btnId, config]) => {
        const button = document.getElementById(btnId);
        if (button) {
          button.addEventListener('click', () => {
            currentPiTest = config;
            piText.textContent = config.instruction;
            piModal.classList.remove('hidden');
          });
        }
      });

      confirmPiBtn.addEventListener('click', () => {
        if (currentPiTest.url) window.open(currentPiTest.url, '_blank');
        if (currentPiTest.next) {
          document.getElementById(currentPiTest.next).disabled = false;
          AppState.completedTests.add(currentPiTest.next);
          saveProgress();
        }
        piModal.classList.add('hidden');
      });

      // Logical Test modals
      const warningModal = document.getElementById('warningModal');
      const confirmModalBtn = document.getElementById('confirmModalBtn');
      const cancelModalBtn = document.getElementById('cancelModalBtn');
      let currentLogicalTest = {};

      Object.entries(logicalTestConfig).forEach(([btnId, config]) => {
        const button = document.getElementById(btnId);
        if (button) {
          button.addEventListener('click', () => {
            currentLogicalTest = config;
            warningModal.classList.remove('hidden');
          });
        }
      });

      cancelModalBtn.addEventListener('click', () => warningModal.classList.add('hidden'));
      
      confirmModalBtn.addEventListener('click', () => {
        if (currentLogicalTest.url) window.open(currentLogicalTest.url, '_blank');
        if (currentLogicalTest.next) {
          document.getElementById(currentLogicalTest.next).disabled = false;
          AppState.completedTests.add(currentLogicalTest.next);
          saveProgress();
        }
        warningModal.classList.add('hidden');
      });

      // English test link
      const englishLink = document.getElementById('english-link');
      if (englishLink) {
        englishLink.addEventListener('click', () => {
          document.getElementById('finish-test-btn').disabled = false;
          AppState.completedTests.add('english');
          saveProgress();
        });
      }

      // Completion modal
      const completionModal = document.getElementById('completionModal');
      const finishTestBtn = document.getElementById('finish-test-btn');
      const confirmCompletionBtn = document.getElementById('confirmCompletionBtn');
      const cancelCompletionBtn = document.getElementById('cancelCompletionBtn');
      const completionChecklist = document.getElementById('completionChecklist');

      if (finishTestBtn) {
        finishTestBtn.addEventListener('click', (e) => {
          e.preventDefault();
          completionModal.classList.remove('hidden');
        });
      }

      if (cancelCompletionBtn) {
        cancelCompletionBtn.addEventListener('click', () => {
          completionModal.classList.add('hidden');
        });
      }

      if (confirmCompletionBtn) {
        confirmCompletionBtn.addEventListener('click', () => {
          showPage('page-complete');
          completionModal.classList.add('hidden');
        });
      }

      if (completionChecklist) {
        completionChecklist.addEventListener('change', () => {
          const checkboxes = completionChecklist.querySelectorAll('input[type="checkbox"]');
          const allChecked = Array.from(checkboxes).every(cb => cb.checked);
          confirmCompletionBtn.disabled = !allChecked;
        });
      }

      // Close modals on backdrop click
      [piModal, warningModal, completionModal].forEach(modal => {
        if (modal) {
          modal.addEventListener('click', (e) => {
            if (e.target === modal) {
              modal.classList.add('hidden');
            }
          });
        }
      });

      // Keyboard accessibility - Escape to close modals
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          [piModal, warningModal, completionModal].forEach(modal => {
            if (modal && !modal.classList.contains('hidden')) {
              modal.classList.add('hidden');
            }
          });
        }
      });

      // Initialize progress bar
      updateProgressBar(1);
    });
  </script>
</body>
</html>