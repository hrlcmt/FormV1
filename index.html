<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>แบบทดสอบออนไลน์</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style> 
    body {
        font-family:'Prompt', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans Thai', sans-serif;
    } 
    .page {
        display: none; /* Hide all pages by default */
    }
    .page.active {
        display: block; /* Show only the active page */
    }
  </style>
</head>
<body class="min-h-screen bg-slate-50 relative overflow-x-hidden">
  <!-- Decorative background -->
  <div aria-hidden="true" class="pointer-events-none absolute inset-x-0 -top-40 -z-10 flex justify-center opacity-60">
    <div class="h-72 w-[56rem] bg-gradient-to-tr from-blue-300 via-cyan-200 to-blue-100 blur-3xl rounded-full"></div>
  </div>
  <div aria-hidden="true" class="pointer-events-none absolute inset-0 -z-10" style="background-image: radial-gradient(circle at 1px 1px, rgba(99,102,241,.15) 1px, transparent 0); background-size: 24px 24px;"></div>
  
  <main class="max-w-3xl mx-auto p-6 md:p-10">
    
    <!-- Page 1: Registration (Updated with your provided code) -->
    <div id="page-register" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-6 text-center">
                <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" />
                <h1 class="text-3xl md:text-4xl font-extrabold text-blue-700 leading-tight">ลงทะเบียน</h1>
                <h2 class="text-2xl md:text-3xl font-extrabold text-blue-700">ทำแบบทดสอบออนไลน์</h2>
                <p class="text-blue-500 mt-2">สำหรับ บริษัท แอล ซี เอ็ม ที</p>
            </header>
            <form id="registerForm" class="space-y-5" novalidate>
                <div>
                    <label for="firstName" class="block font-medium">ชื่อ (ภาษาอังกฤษเท่านั้น) <span class="text-rose-500">*</span></label>
                    <input id="firstName" name="FirstName" type="text" inputmode="text" placeholder="e.g., Nattapong" required pattern="[A-Za-z]+(?:[\s\-'][A-Za-z]+)*" class="mt-1 w-full rounded-xl border border-blue-100 px-3 py-2.5 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100" aria-describedby="firstNameError"/>
                    <p id="firstNameError" class="mt-1 text-sm text-rose-600 hidden" aria-live="polite">กรุณากรอกเป็นตัวอักษรภาษาอังกฤษเท่านั้น (A–Z, a–z, อนุญาตให้มีเว้นวรรค/เครื่องหมาย - หรือ ')</p>
                </div>
                <div>
                    <label for="lastName" class="block font-medium">นามสกุล (ภาษาอังกฤษเท่านั้น) <span class="text-rose-500">*</span></label>
                    <input id="lastName" name="LastName" type="text" inputmode="text" placeholder="e.g., Chaiyaphum" required pattern="[A-Za-z]+(?:[\s\-'][A-Za-z]+)*" class="mt-1 w-full rounded-xl border border-blue-100 px-3 py-2.5 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100" aria-describedby="lastNameError"/>
                    <p id="lastNameError" class="mt-1 text-sm text-rose-600 hidden" aria-live="polite">กรุณากรอกเป็นตัวอักษรภาษาอังกฤษเท่านั้น (A–Z, a–z, อนุญาตให้มีเว้นวรรค/เครื่องหมาย - หรือ ')</p>
                </div>
                <div>
                    <label for="email" class="block font-medium">อีเมล (ต้องใช้งานได้จริง) <span class="text-rose-500">*</span></label>
                    <input id="email" name="Email" type="email" inputmode="email" placeholder="name@example.com" required class="mt-1 w-full rounded-xl border border-blue-100 px-3 py-2.5 shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100" aria-describedby="emailError"/>
                    <p id="emailError" class="mt-1 text-sm text-rose-600 hidden" aria-live="polite">กรุณากรอกอีเมลที่ถูกต้อง (จะมีการส่งลิงก์ทำแบบทดสอบไปยังอีเมลนี้)</p>
                </div>
                <div>
                    <label for="position" class="block font-medium">ตำแหน่งที่สมัคร <span class="text-rose-500">*</span></label>
                    <select id="position" name="Position" required class="mt-1 w-full rounded-xl border border-blue-100 px-3 py-2.5 bg-white shadow-sm focus:outline-none focus:border-blue-600 focus:ring-4 focus:ring-blue-100" aria-describedby="positionError">
                        <option value="" selected disabled>— เลือกตำแหน่ง —</option>
                        <option>เจ้าหน้าที่เอกสารแผนเรือ (Document Planner)</option>
                        <option>ช่างซ่อมบำรุงเครน (Crane Technician)</option>
                        <option>ช่างซ่อมรถยนต์ (Mobile Technician)</option>
                        <option>Marketing & Data Analysis</option>
                        <option>พนักงานตอบแชท Line OA (สำหรับผู้พิการ)</option>
                        <option>AP Accountant</option>
                        <option>Billing Officer</option>
                        <option>Document Clerk (สัญญาจ้าง 6 เดือน)</option>
                        <option>พนักงานตอบแชท Line OA (สัญญาจ้าง 6 เดือน)</option>
                        <option>Content Creator (สัญญาจ้าง 1 ปี)</option>
                        <option>Cashier (สัญญาจ้าง 6 เดือน)</option>
                        <option>Assistant QSSHE Manager</option>
                        <option>IT cyber security</option>
                        <option>Vessel planner</option>
                    </select>
                    <p id="positionError" class="mt-1 text-sm text-rose-600 hidden" aria-live="polite">กรุณาเลือกตำแหน่งที่ต้องการสมัคร</p>
                </div>
                <div class="flex items-start gap-3">
                    <input id="confirmEmail" type="checkbox" class="mt-1 h-4 w-4 rounded border-blue-100 accent-blue-600" required />
                    <label for="confirmEmail" class="text-sm text-gray-700">ยืนยันว่าอีเมลนี้ใช้งานได้จริงและฉันสามารถรับอีเมลได้</label>
                </div>
                <div class="pt-2 flex items-center gap-3">
                    <button id="submitBtn" type="submit" class="rounded-xl px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg shadow-blue-500/30 disabled:opacity-50 disabled:cursor-not-allowed">ลงทะเบียน</button>
                    <button id="resetBtn" type="button" class="rounded-xl px-4 py-3 border border-blue-100 bg-white/60 hover:bg-white">ล้างข้อมูล</button>
                </div>
                 <div id="successBox" class="hidden mt-4 rounded-2xl border border-emerald-200 bg-emerald-50 p-4 text-emerald-800" role="status" aria-live="polite">
                    ✅ ลงทะเบียนสำเร็จ! กำลังพาไปหน้าถัดไป…
                </div>
            </form>
        </div>
    </div>

    <!-- Page 2: Instructions -->
    <div id="page-instructions" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center">
                <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" />
                <h1 class="text-3xl md:text-4xl font-extrabold text-blue-700 leading-tight">คำแนะนำ</h1>
                <p class="text-slate-500 mt-2">ภาพรวมของแบบทดสอบออนไลน์</p>
            </header>
            <div class="text-center">
                 <img src="https://img2.pic.in.th/pic/The-Predictive-Index--2-.png" alt="คำแนะนำการทดสอบ" class="w-full max-w-2xl mx-auto rounded-lg shadow-md">
            </div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-register" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="instructions-next-btn" class="rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2"><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 3: PI Test A -->
    <div id="page-pi-a" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">🔹 1. The Predictive Index</h1>
                <p class="mt-1 text-xl font-semibold text-slate-700">แบบทดสอบชุด A</p>
                <h2 class="mt-6 text-xl font-semibold text-red-600">หัวข้อ: มุมมองจาก “ผู้อื่นมองว่าคุณเป็นคนแบบไหน”</h2>
                <p class="mt-4 max-w-2xl mx-auto text-slate-600">กรุณาเลือกลักษณะนิสัยที่ท่านคิดว่าผู้อื่นมองว่าท่านเป็นแบบนั้น โดยสามารถเลือกได้ไม่จำกัดจำนวนข้อ เมื่อทำเสร็จเรียบร้อยแล้ว กรุณากดส่งและไปยังแบบทดสอบชุดถัดไป</p>
            </div>
            <div class="mt-10 text-center">
                <img src="https://img5.pic.in.th/file/secure-sv1/5f04db6d-b251-4b2c-ae65-3b2b84ebe144.png" alt="Click icon" class="h-96 w-auto mx-auto mb-6">
                <button id="startPiTestA" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">คลิกทำแบบทดสอบ</button>
            </div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-instructions" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="pi-a-next" data-nextpage="page-pi-b" class="nav-btn rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 4: PI Test B -->
    <div id="page-pi-b" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">🔹 2. The Predictive Index</h1>
                <p class="mt-1 text-xl font-semibold text-slate-700">แบบทดสอบชุด B</p>
                <h2 class="mt-6 text-xl font-semibold text-red-600">หัวข้อ: มุมมองจาก “ตัวคุณมองว่าคุณเป็นคนแบบไหน”</h2>
                <p class="mt-4 max-w-2xl mx-auto text-slate-600">กรุณาเลือกลักษณะนิสัยที่ท่านคิดว่าท่านเป็น โดยสามารถเลือกได้ไม่จำกัดจำนวนข้อ เมื่อทำเสร็จเรียบร้อยแล้ว กรุณากดส่งและไปยังแบบทดสอบชุดถัดไป</p>
            </div>
            <div class="mt-10 text-center">
                <img src="https://img2.pic.in.th/pic/ChatGPT-Image-16-..-2568-11_32_11.png" alt="Click icon" class="h-96 w-auto mx-auto mb-6">
                <button id="startPiTestB" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">คลิกเพื่อทำแบบทดสอบชุด B</button>
            </div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-pi-a" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="pi-b-next" data-nextpage="page-logical-intro" class="nav-btn rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 5: Logical Reasoning Intro -->
    <div id="page-logical-intro" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">แบบทดสอบตรรกะ (Logical Reasoning)</h1>
                <div class="mt-4 max-w-2xl mx-auto text-slate-600 space-y-2">
                    <p>ส่วนนี้เป็นแบบทดสอบเพื่อวัดความสามารถด้านการใช้เหตุผล</p>
                    <p>มีทั้งหมด 3 ชุด (50 ข้อ/ชุด) โดยแต่ละชุดมีเวลาจำกัด <strong class="text-red-600">12 นาทีเท่านั้น</strong></p>
                </div>
                <div class="mt-6 max-w-2xl mx-auto border-2 border-blue-500 rounded-2xl p-4 bg-blue-50/50">
                    <p class="text-xl font-semibold text-blue-800">ทุกชุดจะมีให้ใส่รหัสผ่าน</p>
                    <p class="mt-2 text-lg text-slate-700">สามารถขอรหัสได้ที่ LINE OFFICIAL <a href="https://lin.ee/xYHJZkc" target="_blank" rel="noopener" class="text-blue-600 font-bold hover:underline">คลิกที่นี่</a></p>
                    <p class="mt-1 text-lg text-slate-600">(โดยเลือกที่ "ปุ่มเมนู" และ "ขอรหัส")</p>
                </div>
                <p class="mt-6 text-xl md:text-2xl font-bold text-slate-800">คุณจะต้องทำแบบทดสอบตามลำดับตั้งแต่ชุดที่ 1 ถึง 3</p>
            </div>
            <div class="mt-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-121252.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg"></div>
            <div class="mt-8 text-center"><button id="startTestBtn1" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">เริ่มทำแบบทดสอบชุดที่ 1</button></div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-pi-b" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="logical-intro-next" data-nextpage="page-logical-set2" class="nav-btn rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 6: Logical Reasoning Set 2 -->
    <div id="page-logical-set2" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">ชุดที่ 2</h1>
                <p class="mt-1 text-xl font-semibold text-slate-700">แบบทดสอบตรรกะ (Logical Reasoning)</p>
                <p class="mt-6 text-xl md:text-2xl font-bold text-slate-800">คุณจะต้องทำแบบทดสอบตามลำดับตั้งแต่ชุดที่ 2 ถึง 3</p>
            </div>
            <div class="mt-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-122427.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg"></div>
            <div class="mt-8 text-center"><button id="startTestBtn2" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">เริ่มทำแบบทดสอบชุดที่ 2</button></div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-logical-intro" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="logical-set2-next" data-nextpage="page-logical-set3" class="nav-btn rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 7: Logical Reasoning Set 3 -->
    <div id="page-logical-set3" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">ชุดที่ 3</h1>
                <p class="mt-1 text-xl font-semibold text-slate-700">แบบทดสอบตรรกะ (Logical Reasoning)</p>
                <p class="mt-6 text-xl md:text-2xl font-bold text-slate-800">นี่คือแบบทดสอบตรรกะชุดสุดท้าย</p>
            </div>
            <div class="mt-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-16-122427.png" alt="Logical Reasoning" class="max-w-xs md:max-w-sm mx-auto rounded-lg"></div>
            <div class="mt-8 text-center"><button id="startTestBtn3" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">เริ่มทำแบบทดสอบชุดที่ 3</button></div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-logical-set2" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="logical-set3-next" data-nextpage="page-english-intro" class="nav-btn rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ถัดไป</span></button>
            </div>
        </div>
    </div>

    <!-- Page 8: English Test Intro -->
    <div id="page-english-intro" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center"><img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" /></header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-blue-700">แบบทดสอบภาษาอังกฤษ</h1>
                <p class="mt-1 text-xl font-semibold text-slate-700">English Testing</p>
                <p class="mt-6 text-lg text-slate-800">จำนวน 28 ข้อ กำหนดเวลา <strong class="text-red-600">25 นาที</strong></p>
            </div>
            <div class="mt-10 text-center">
                <a id="english-link" href="https://www.classmarker.com/online-test/start/access-code/?quiz=pgn686b47061a703" target="_blank" rel="noopener noreferrer" class="inline-block w-full md:w-auto rounded-xl px-8 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg shadow-lg">🔗 คลิกเพื่อทำแบบทดสอบภาษาอังกฤษ</a>
            </div>
            <div class="mt-12 flex justify-between items-center">
                <button data-backpage="page-logical-set3" class="nav-btn rounded-xl px-6 py-2 border border-slate-300 bg-white hover:bg-slate-100 text-slate-700 font-semibold flex items-center gap-2"><span>ย้อนกลับ</span></button>
                <button id="finish-test-btn" class="rounded-xl px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed" disabled><span>ทำแบบทดสอบเสร็จสิ้น</span></button>
            </div>
        </div>
    </div>

    <!-- Page 9: Completion -->
    <div id="page-complete" class="page">
        <div class="mt-8 bg-white/80 backdrop-blur-xl border border-white/60 shadow-xl shadow-slate-200/60 rounded-3xl p-6 md:p-8">
            <header class="mb-8 text-center">
                <img src="https://img5.pic.in.th/file/secure-sv1/Screenshot-2025-08-05-100939.png" alt="โลโก้บริษัท" class="mx-auto mb-4 md:mb-6 w-full max-w-[420px] object-contain" />
            </header>
            <div class="text-center">
                <h1 class="text-2xl md:text-3xl font-bold text-emerald-600">ทำแบบทดสอบเสร็จสิ้นเรียบร้อย</h1>
                <div class="mt-6 text-left max-w-md mx-auto bg-slate-50 border border-slate-200 rounded-lg p-4 space-y-2">
                    <p><strong>ชื่อ-นามสกุล:</strong> <span id="display-fullname"></span></p>
                    <p><strong>อีเมล:</strong> <span id="display-email"></span></p>
                    <p><strong>ตำแหน่งที่สมัคร:</strong> <span id="display-position"></span></p>
                    <p><strong>IP Address:</strong> <span id="display-ip"></span></p>
                </div>
                <div class="mt-6 max-w-lg mx-auto border-2 border-rose-500 rounded-2xl p-4 bg-rose-50/50">
                    <p class="text-lg font-semibold text-rose-800">สำคัญมาก!</p>
                    <p class="mt-2 text-base text-slate-700">กรุณาแคปหน้าจอนี้ เพื่อส่งยืนยันใน LINE OFFICIAL</p>
                    <p class="mt-1 text-base text-slate-600">หากไม่แคปหน้าจอนี้ เราจะถือว่าคุณยังทำแบบทดสอบไม่เสร็จสิ้น และจะไม่ทำการตรวจข้อสอบแต่อย่างใด</p>
                </div>
            </div>
        </div>
    </div>

  </main>

  <!-- Instruction Confirmation Modal -->
  <div id="instructionConfirmModal" class="fixed inset-0 bg-black bg-opacity-60 hidden grid place-items-center z-50 p-4">
    <div class="bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
        <h2 class="text-2xl font-bold text-blue-700 text-center">ยืนยันความเข้าใจ</h2>
        <p class="mt-4 text-center text-slate-700">คุณเข้าใจในกระบวนการทำแบบทดสอบทั้งหมดแล้วใช่ไหม และจะไม่ลืมแคปหน้าจอเมื่อทำแบบทดสอบทุกอย่างเสร็จสิ้น</p>
        <div class="mt-8 flex flex-col sm:flex-row-reverse gap-3">
            <button id="confirmInstructionBtn" class="w-full rounded-lg px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg">ใช่, ฉันเข้าใจ</button>
            <button id="cancelInstructionBtn" class="w-full rounded-lg px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-lg">ยกเลิก</button>
        </div>
    </div>
  </div>

  <!-- PI Instruction Modal -->
  <div id="piInstructionModal" class="fixed inset-0 bg-black bg-opacity-60 hidden grid place-items-center z-50 p-4">
    <div class="bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
        <h2 class="text-2xl font-bold text-blue-700 text-center">คำแนะนำ</h2>
        <p id="piInstructionText" class="mt-4 text-center text-slate-700 text-lg"></p>
        <div class="mt-6">
            <button id="confirmPiModalBtn" class="w-full rounded-lg px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg">รับทราบและเริ่มทำแบบทดสอบ</button>
        </div>
    </div>
  </div>

  <!-- Warning Modal -->
  <div id="warningModal" class="fixed inset-0 bg-black bg-opacity-60 hidden grid place-items-center z-50 p-4">
    <div class="bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
        <h2 class="text-3xl font-extrabold text-rose-600 text-center">สำคัญมากๆ</h2>
        <ul class="list-disc list-inside mt-6 space-y-4 text-slate-700 text-lg">
            <li>พยายามตอบให้ถูกต้องและมากที่สุดภายในเวลาที่กำหนด</li>
            <li>สามารถข้ามข้อได้ ไม่จำเป็นต้องทำทุกข้อขึ้นอยู่กับเทคนิคของคุณเอง</li>
            <li>ระบบจะตรวจจับการทำแบบทดสอบแบบ <strong>Full Screen เท่านั้น</strong></li>
            <li>หากออกจากหน้าแบบทดสอบ หรือเปลี่ยนหน้าเว็บไซต์เกิน 2 ครั้ง ระบบจะถือว่าการสอบเป็น <strong class="text-red-600">“โมฆะ”</strong></li>
        </ul>
        <div class="mt-8 flex flex-col sm:flex-row-reverse gap-3">
            <button id="confirmModalBtn" class="w-full rounded-lg px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg">รับทราบและเริ่มทำแบบทดสอบ</button>
            <button id="cancelModalBtn" class="w-full rounded-lg px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-lg">ยกเลิก</button>
        </div>
    </div>
  </div>

  <!-- Completion Confirmation Modal -->
  <div id="completionModal" class="fixed inset-0 bg-black bg-opacity-60 hidden grid place-items-center z-50 p-4">
    <div class="bg-white rounded-2xl p-6 md:p-8 max-w-lg w-full shadow-2xl">
        <h2 class="text-2xl font-bold text-blue-700 text-center">ยืนยันการส่งแบบทดสอบ</h2>
        <p class="mt-4 text-center text-slate-700">คุณมั่นใจว่าคุณได้ทำข้อสอบทุกอย่างเสร็จหมดแล้ว? หากไม่ได้ทำครบทุกชุด จะถือว่าแบบทดสอบยังไม่เสร็จสิ้น และข้อสอบจะไม่ถูกส่งมายังระบบ</p>
        <div id="completionChecklist" class="mt-6 space-y-3 text-left">
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>The Predictive Index ชุด 1</span></label>
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>The Predictive Index ชุด 2</span></label>
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>แบบทดสอบตรรกะ ชุด 1</span></label>
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>แบบทดสอบตรรกะ ชุด 2</span></label>
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>แบบทดสอบตรรกะ ชุด 3</span></label>
            <label class="flex items-center space-x-3 p-3 bg-slate-50 rounded-lg"><input type="checkbox" class="h-5 w-5 rounded accent-blue-600"><span>แบบทดสอบภาษาอังกฤษ</span></label>
        </div>
        <div class="mt-8 flex flex-col gap-3">
            <button id="confirmCompletionBtn" class="w-full rounded-lg px-5 py-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold text-lg disabled:opacity-50 disabled:cursor-not-allowed" disabled>ยืนยันและเสร็จสิ้น</button>
            <button id="cancelCompletionBtn" class="w-full rounded-lg px-5 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-semibold text-lg">ยกเลิก</button>
        </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- IMPORTANT: PASTE YOUR GOOGLE APPS SCRIPT URL HERE ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwL9tXTVR_qnEUcik37QeGHlWxMgNjMr0WkktxrkLPoaHiUSiXre7G0-xr5bSi9RFpPYw/exec';

        const pages = document.querySelectorAll('.page');
        const navButtons = document.querySelectorAll('.nav-btn');
        const registerForm = document.getElementById('registerForm');
        let userData = {};

        function showPage(pageId) {
            window.scrollTo(0, 0); // Scroll to top on page change
            localStorage.setItem('currentPageId', pageId);
            pages.forEach(page => page.classList.remove('active'));
            const newPage = document.getElementById(pageId);
            if (newPage) {
                newPage.classList.add('active');
                if (pageId === 'page-complete') {
                    document.getElementById('display-fullname').textContent = `${userData.firstName || ''} ${userData.lastName || ''}`;
                    document.getElementById('display-email').textContent = userData.email || '';
                    document.getElementById('display-position').textContent = userData.position || '';
                    document.getElementById('display-ip').textContent = userData.ip || 'ไม่สามารถบันทึกได้';
                }
            }
        }

        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetPageId = button.dataset.nextpage || button.dataset.backpage;
                if (targetPageId) showPage(targetPageId);
            });
        });

        // --- Improved Validation Logic ---
        const nameRegex = /^[A-Za-z]+(?:[\s\-'][A-Za-z]+)*$/;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[A-Za-z]{2,}$/;

        function setFieldValidity(inputEl, isValid, errorEl) {
            if (isValid) {
                inputEl.classList.remove('border-rose-400');
                if(errorEl) errorEl.classList.add('hidden');
            } else {
                inputEl.classList.add('border-rose-400');
                if(errorEl) errorEl.classList.remove('hidden');
            }
        }

        function validateForm() {
            const fields = {
                firstName: nameRegex.test(document.getElementById('firstName').value.trim()),
                lastName: nameRegex.test(document.getElementById('lastName').value.trim()),
                email: emailRegex.test(document.getElementById('email').value.trim()),
                position: !!document.getElementById('position').value,
                confirmEmail: document.getElementById('confirmEmail').checked
            };

            setFieldValidity(document.getElementById('firstName'), fields.firstName, document.getElementById('firstNameError'));
            setFieldValidity(document.getElementById('lastName'), fields.lastName, document.getElementById('lastNameError'));
            setFieldValidity(document.getElementById('email'), fields.email, document.getElementById('emailError'));
            setFieldValidity(document.getElementById('position'), fields.position, document.getElementById('positionError'));
            setFieldValidity(document.getElementById('confirmEmail'), fields.confirmEmail, null);
            
            return Object.values(fields).every(Boolean);
        }

        registerForm.addEventListener('input', () => {
            const isValid = validateForm();
            document.getElementById('submitBtn').disabled = !isValid;
        });
        

        registerForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            if (!validateForm()) return;
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'กำลังบันทึกข้อมูล...';

            userData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                position: document.getElementById('position').value,
            };
            localStorage.setItem('userData', JSON.stringify(userData));
            
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                userData.ip = data.ip;
            } catch (error) {
                console.error('Could not fetch IP address:', error);
                userData.ip = 'N/A';
            }

            const formData = new FormData();
            formData.append('FirstName', userData.firstName);
            formData.append('LastName', userData.lastName);
            formData.append('Email', userData.email);
            formData.append('Position', userData.position);
            formData.append('IPAddress', userData.ip);

            try {
                const res = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
                if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
                const result = await res.json();
                if(result.result === 'success') {
                    console.log('Data saved to Google Sheet');
                    showPage('page-instructions');
                } else {
                    throw new Error(JSON.stringify(result.error));
                }
            } catch (error) {
                console.error('Error saving to Google Sheet:', error);
                alert('เกิดข้อผิดพลาดในการบันทึกข้อมูล: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'ลงทะเบียนและไปต่อ';
            }
        });
        
        const resetBtn = document.getElementById('resetBtn');
        if(resetBtn) {
            resetBtn.addEventListener('click', () => {
                registerForm.reset();
                document.querySelectorAll('#registerForm input, #registerForm select').forEach(el => {
                    el.classList.remove('border-rose-400');
                });
                document.querySelectorAll('#registerForm p[id$="Error"]').forEach(p => p.classList.add('hidden'));
                document.getElementById('submitBtn').disabled = true;
            });
        }
        
        // --- Instruction Confirmation Modal ---
        const instructionConfirmModal = document.getElementById('instructionConfirmModal');
        const instructionsNextBtn = document.getElementById('instructions-next-btn');
        const confirmInstructionBtn = document.getElementById('confirmInstructionBtn');
        const cancelInstructionBtn = document.getElementById('cancelInstructionBtn');

        if (instructionsNextBtn) {
            instructionsNextBtn.addEventListener('click', (e) => {
                e.preventDefault();
                instructionConfirmModal.classList.remove('hidden');
            });
        }
        if (cancelInstructionBtn) {
            cancelInstructionBtn.addEventListener('click', () => {
                instructionConfirmModal.classList.add('hidden');
            });
        }
        if (confirmInstructionBtn) {
            confirmInstructionBtn.addEventListener('click', () => {
                showPage('page-pi-a');
                instructionConfirmModal.classList.add('hidden');
            });
        }


        // --- PI Instruction Modal Logic ---
        const piInstructionModal = document.getElementById('piInstructionModal');
        const piInstructionText = document.getElementById('piInstructionText');
        const confirmPiModalBtn = document.getElementById('confirmPiModalBtn');
        let currentPiTest = {};

        const piTestButtons = {
            startPiTestA: {
                url: 'https://docs.google.com/forms/d/e/1FAIpQLSf1bMAy5RZ1dGTQGeoaAvA-B0LJ4Z4xaxM8vdwkBZqwIGowZA/viewform',
                next: 'pi-a-next',
                instruction: 'คุณสามารถเลือกได้ไม่จำกัดจำนวนข้อ หากคุณคิดว่า ผู้อื่นมองว่าคุณเป็นคนแบบนั้น'
            },
            startPiTestB: {
                url: 'https://docs.google.com/forms/d/e/1FAIpQLSf9UMwFSVatVey0ivACu3wk4kPyvI3VL2NQXNUn2_zZA7noSg/viewform',
                next: 'pi-b-next',
                instruction: 'คุณสามารถเลือกได้ไม่จำกัดจำนวนข้อ หากคุณคิดว่า คุณมองว่าคุณเป็นคนแบบที่คุณคิดว่าเป็นคุณเอง'
            }
        };

        Object.keys(piTestButtons).forEach(btnId => {
            const button = document.getElementById(btnId);
            if (button) {
                button.addEventListener('click', () => {
                    currentPiTest = piTestButtons[btnId];
                    piInstructionText.textContent = currentPiTest.instruction;
                    piInstructionModal.classList.remove('hidden');
                });
            }
        });

        confirmPiModalBtn.addEventListener('click', () => {
            if (currentPiTest.url) window.open(currentPiTest.url, '_blank');
            if (currentPiTest.next) document.getElementById(currentPiTest.next).disabled = false;
            localStorage.setItem(currentPiTest.next + '-enabled', 'true');
            piInstructionModal.classList.add('hidden');
        });


        // --- Logical Reasoning Warning Modal Logic ---
        const warningModal = document.getElementById('warningModal');
        const confirmModalBtn = document.getElementById('confirmModalBtn');
        const cancelModalBtn = document.getElementById('cancelModalBtn');
        let currentLogicalTest = {};

        const modalTestButtons = {
            startTestBtn1: { url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=r4e686b42fada169', next: 'logical-intro-next' },
            startTestBtn2: { url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=99b686b44e854477', next: 'logical-set2-next' },
            startTestBtn3: { url: 'https://www.classmarker.com/online-test/start/access-code/?quiz=tmg686b45fb6b665', next: 'logical-set3-next' }
        };

        Object.keys(modalTestButtons).forEach(btnId => {
            const button = document.getElementById(btnId);
            if (button) {
                button.addEventListener('click', () => {
                    currentLogicalTest = modalTestButtons[btnId];
                    warningModal.classList.remove('hidden');
                });
            }
        });
        
        const englishLink = document.getElementById('english-link');
        if(englishLink){
            englishLink.addEventListener('click', () => {
                document.getElementById('finish-test-btn').disabled = false;
                localStorage.setItem('finish-test-btn-enabled', 'true');
            });
        }

        cancelModalBtn.addEventListener('click', () => warningModal.classList.add('hidden'));
        confirmModalBtn.addEventListener('click', () => {
            if (currentLogicalTest.url) window.open(currentLogicalTest.url, '_blank');
            if (currentLogicalTest.next) {
                document.getElementById(currentLogicalTest.next).disabled = false;
                localStorage.setItem(currentLogicalTest.next + '-enabled', 'true');
            }
            warningModal.classList.add('hidden');
        });

        // --- Completion Modal Logic ---
        const completionModal = document.getElementById('completionModal');
        const finishTestBtn = document.getElementById('finish-test-btn');
        const completionChecklist = document.getElementById('completionChecklist');
        const confirmCompletionBtn = document.getElementById('confirmCompletionBtn');
        const cancelCompletionBtn = document.getElementById('cancelCompletionBtn');

        if(finishTestBtn) {
            finishTestBtn.addEventListener('click', (e) => {
                e.preventDefault();
                completionModal.classList.remove('hidden');
            });
        }

        if(cancelCompletionBtn) {
            cancelCompletionBtn.addEventListener('click', () => {
                completionModal.classList.add('hidden');
            });
        }

        if(confirmCompletionBtn) {
            confirmCompletionBtn.addEventListener('click', () => {
                showPage('page-complete');
                completionModal.classList.add('hidden');
            });
        }

        if(completionChecklist) {
            completionChecklist.addEventListener('change', () => {
                const checkboxes = completionChecklist.querySelectorAll('input[type="checkbox"]');
                const allChecked = Array.from(checkboxes).every(cb => cb.checked);
                confirmCompletionBtn.disabled = !allChecked;
            });
        }

        // --- Restore State on Page Load ---
        const savedPageId = localStorage.getItem('currentPageId');
        const savedUserData = localStorage.getItem('userData');

        if (savedUserData) {
            userData = JSON.parse(savedUserData);
        }

        if (savedPageId) {
            showPage(savedPageId);
        } else {
            showPage('page-register');
        }
        
        // Restore button states
        ['pi-a-next', 'pi-b-next', 'logical-intro-next', 'logical-set2-next', 'logical-set3-next', 'finish-test-btn'].forEach(btnId => {
            if(localStorage.getItem(btnId + '-enabled') === 'true') {
                const btn = document.getElementById(btnId);
                if(btn) btn.disabled = false;
            }
        });
        document.getElementById('submitBtn').disabled = !validateForm();


    });
  </script>

</body>
</html>
